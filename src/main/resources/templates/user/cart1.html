<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<title>Travel-FPoly</title>
<meta charset="utf-8">
<link href="/user/images/bee.png" rel="icon">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="/user/images/bee.png" rel="icon">
<link
	href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700"
	rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Alex+Brush"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
	crossorigin="anonymous">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
	crossorigin="anonymous"></script>

<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
<link rel="stylesheet" href="/user/css/open-iconic-bootstrap.min.css">
<link rel="stylesheet" href="/user/css/animate.css">
<link rel="stylesheet" href="/user/css/owl.carousel.min.css">
<link rel="stylesheet" href="/user/css/owl.theme.default.min.css">
<link rel="stylesheet" href="/user/css/magnific-popup.css">
<link rel="stylesheet" href="/user/css/aos.css">
<link rel="stylesheet" href="/user/css/ionicons.min.css">
<link rel="stylesheet" href="/user/css/bootstrap-datepicker.css">
<link rel="stylesheet" href="/user/css/jquery.timepicker.css">
<link rel="stylesheet" href="/user/css/flaticon.css">
<link rel="stylesheet" href="/user/css/icomoon.css">
<link rel="stylesheet" href="/user/css/style.css">
<link rel="stylesheet" type="text/css" href="/admin/css/main.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">
  <!-- or -->
  <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
  <!-- Font-icon css-->
  <link rel="stylesheet" type="text/css"
    href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">

<script nonce="6d052e1f-c170-4fc3-9b38-e3eeb83f439d">(function(w,d){!function(dK,dL,dM,dN){dK[dM]=dK[dM]||{};dK[dM].executed=[];dK.zaraz={deferred:[],listeners:[]};dK.zaraz.q=[];dK.zaraz._f=function(dO){return function(){var dP=Array.prototype.slice.call(arguments);dK.zaraz.q.push({m:dO,a:dP})}};for(const dQ of["track","set","debug"])dK.zaraz[dQ]=dK.zaraz._f(dQ);dK.zaraz.init=()=>{var dR=dL.getElementsByTagName(dN)[0],dS=dL.createElement(dN),dT=dL.getElementsByTagName("title")[0];dT&&(dK[dM].t=dL.getElementsByTagName("title")[0].text);dK[dM].x=Math.random();dK[dM].w=dK.screen.width;dK[dM].h=dK.screen.height;dK[dM].j=dK.innerHeight;dK[dM].e=dK.innerWidth;dK[dM].l=dK.location.href;dK[dM].r=dL.referrer;dK[dM].k=dK.screen.colorDepth;dK[dM].n=dL.characterSet;dK[dM].o=(new Date).getTimezoneOffset();if(dK.dataLayer)for(const dX of Object.entries(Object.entries(dataLayer).reduce(((dY,dZ)=>({...dY[1],...dZ[1]})),{})))zaraz.set(dX[0],dX[1],{scope:"page"});dK[dM].q=[];for(;dK.zaraz.q.length;){const d_=dK.zaraz.q.shift();dK[dM].q.push(d_)}dS.defer=!0;for(const ea of[localStorage,sessionStorage])Object.keys(ea||{}).filter((ec=>ec.startsWith("_zaraz_"))).forEach((eb=>{try{dK[dM]["z_"+eb.slice(7)]=JSON.parse(ea.getItem(eb))}catch{dK[dM]["z_"+eb.slice(7)]=ea.getItem(eb)}}));dS.referrerPolicy="origin";dS.src="../../cdn-cgi/zaraz/sd0d9.js?z="+btoa(encodeURIComponent(JSON.stringify(dK[dM])));dR.parentNode.insertBefore(dS,dR)};["complete","interactive"].includes(dL.readyState)?zaraz.init():dK.addEventListener("DOMContentLoaded",zaraz.init)}(w,d,"zarazData","script");})(window,document);</script>
<link rel="stylesheet"
	href="https://fonts.googleapis.com/icon?family=Material+Icons">
	
<style>
   .custom-form {
   	   top:0;
   	   bottom:0;
   	   left:0;
       width: 100%;
       height: 100%;
       position:fixed;
       background: #283747;
       background: radial-gradient(
           circle,
           rgba(40, 55, 71, 0.5) 0%,
           rgba(0, 0, 0, 0.5) 100%
       );
       display: grid;
       transition: opacity 0.75s, visibility 0.75s;
       z-index: 999;
   }
   .customForm{
   		background-color: white; 
   		border-radius:10px;
   		width:30%;
   		margin:auto;
   		margin-top:10%;
   		padding-top:15px;
   }
   .customForm i{
   		margin-top:-15px;
   		float:right;
   		color: #6e0d02;
   		font-size:24px;
   }
   .customForm i:hover{
   		color: #ff3a24;
   		cursor:pointer;
   }
</style>
</head>
<body>
	<div th:insert="~{include/_loading.html}"></div>
	<div th:insert="~{include/_Nav}"></div>

	<div class="hero-wrap js-fullheight"
		style="background-image: url('/user/images/bg_1.jpg');">
		<div class="overlay"></div>
		<div class="container">
			<div
				class="row no-gutters slider-text js-fullheight align-items-center justify-content-start"
				data-scrollax-parent="true">
				<div class="col-md-9 ftco-animate"
					data-scrollax=" properties: { translateY: '70%' }">
					<h1 class="mb-4"
						data-scrollax="properties: { translateY: '30%', opacity: 1.6 }">
						<strong>Explore <br></strong> your amazing city
					</h1>
					<p data-scrollax="properties: { translateY: '30%', opacity: 1.6 }">Find
						great places to stay, eat, shop, or visit from local experts</p>
					<div class="block-17 my-4">
						<form action="#" method="post" class="d-block d-flex">
							<div class="fields d-block d-flex">
								<div class="textfield-search one-third">
									<input type="text" class="form-control"
										placeholder="Ex: food, service, hotel">
								</div>
								<div class="select-wrap one-third">
									<div class="icon">
										<span class="ion-ios-arrow-down"></span>
									</div>
									<select name="" id="" class="form-control"
										placeholder="Keyword search">
										<option value="">Where</option>
										<option value="">San Francisco USA</option>
										<option value="">Berlin Germany</option>
										<option value="">Lodon United Kingdom</option>
										<option value="">Paris Italy</option>
									</select>
								</div>
							</div>
							<input type="submit" class="search-submit btn btn-primary"
								value="Search">
						</form>
					</div>
					<p>Or browse the highlights</p>
					<p class="browse d-md-flex">
						<span
							class="d-flex justify-content-md-center align-items-md-center"><a
							href="#"><i class="flaticon-fork"></i>Restaurant</a></span> <span
							class="d-flex justify-content-md-center align-items-md-center"><a
							href="#"><i class="flaticon-hotel"></i>Hotel</a></span> <span
							class="d-flex justify-content-md-center align-items-md-center"><a
							href="#"><i class="flaticon-meeting-point"></i>Places</a></span> <span
							class="d-flex justify-content-md-center align-items-md-	center"><a
							href="#"><i class="flaticon-shopping-bag"></i>Shopping</a></span>
					</p>
				</div>
			</div>
		</div>
	</div>
	<section class="ftco-section services-section bg-light">
		<div class="container">
			<div class="row d-flex">
				<div class="col-md-3 d-flex align-self-stretch ftco-animate">
					<div class="media block-6 services d-block text-center">
						<div class="d-flex justify-content-center">
							<div class="icon">
								<span class="flaticon-guarantee"></span>
							</div>
						</div>
						<div class="media-body p-2 mt-2">
							<h3 class="heading mb-3">Best Price Guarantee</h3>
							<p>A small river named Duden flows by their place and
								supplies.</p>
						</div>
					</div>
				</div>
				<div class="col-md-3 d-flex align-self-stretch ftco-animate">
					<div class="media block-6 services d-block text-center">
						<div class="d-flex justify-content-center">
							<div class="icon">
								<span class="flaticon-like"></span>
							</div>
						</div>
						<div class="media-body p-2 mt-2">
							<h3 class="heading mb-3">Travellers Love Us</h3>
							<p>A small river named Duden flows by their place and
								supplies.</p>
						</div>
					</div>
				</div>
				<div class="col-md-3 d-flex align-self-stretch ftco-animate">
					<div class="media block-6 services d-block text-center">
						<div class="d-flex justify-content-center">
							<div class="icon">
								<span class="flaticon-detective"></span>
							</div>
						</div>
						<div class="media-body p-2 mt-2">
							<h3 class="heading mb-3">Best Travel Agent</h3>
							<p>A small river named Duden flows by their place and
								supplies.</p>
						</div>
					</div>
				</div>
				<div class="col-md-3 d-flex align-self-stretch ftco-animate">
					<div class="media block-6 services d-block text-center">
						<div class="d-flex justify-content-center">
							<div class="icon">
								<span class="flaticon-support"></span>
							</div>
						</div>
						<div class="media-body p-2 mt-2">
							<h3 class="heading mb-3">Our Dedicated Support</h3>
							<p>A small river named Duden flows by their place and
								supplies.</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<main class="container-fluid col-11 app app-ban-hang">
		<div class="row">
			<div class="col-md-8">
				<div class="tile">
					<h3 class="tile-title">Cart Detail</h3>
					<input type="text" id="myInput" onkeyup="myFunction()"
						placeholder="Nhập mã sản phẩm hoặc tên sản phẩm để tìm kiếm...">
						<div class="du--lieu-san-pham">
						<table class="table table-hover table-bordered">
							<thead>
								<tr>

									<th class="so--luong">Tour Name</th>
									<th class="so--luong">Star date - End date</th>
									<th class="so--luong" width="10">Quantity Adult</th>
									<th class="so--luong" width="10">Quantity Children</th>
									<th class="so--luong">PriceAdult</th>
									<th class="so--luong">PriceChildren</th>
									<th>Total Price</th>
									<th class="so--luong text-center"
										style="text-align: center; vertical-align: middle;"></th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								<p style="color:red;">[[${message}]]</p>
								<tr th:if="${cartItems}!=null" th:each="cartItem, cartItemStart  : ${cartItems}" class="cart-item">
									<td>[[${cartItem.TourId.Name}]]</td>
									<td>[[${#dates.format(cartItem.StartDate, 'dd-MM-yyyy')}]] - [[${#dates.format(cartItem.EndDate, 'dd-MM-yyyy')}]]</td>
									<td>
										<select th:name="quantityAdult" class="form-control" id="adult">
									        <option>[[${cartItem.QuantityAdult}]]</option>
									        <option th:each="quantityAdult : ${#numbers.sequence(0,cartItem.TourId.quantityAdult)}" th:value="${quantityAdult}">
									            [[${quantityAdult}]]
									        </option>
									    </select>
									</td>
									<td>
										<select th:name="quantityChildren" class="form-control" id="children">
									        <option>[[${cartItem.QuantityChildren}]]</option>
									        <option th:each="quantityChildren : ${#numbers.sequence(0,cartItem.TourId.quantityChildren)}" th:value="${quantityChildren}">
									            [[${quantityChildren}]]
									        </option>
									    </select>
									</td>
									<td id="priceAdult" th:data-price="${cartItem.TourId.PriceAdult}">
										[[${cartItem.TourId.PriceAdult}]]$ 
										
									 </td>
									 <td id="priceChildren" th:data-price="${cartItem.TourId.PriceChildren}">
									 	[[${cartItem.TourId.PriceChildren}]]$
									 </td>
									 
									<td>
										<span id="totalPriceDisplay" style="color:red;" th:text="${(cartItem.TourId.PriceAdult * cartItem.quantityAdult) + (cartItem.TourId.PriceChildren * cartItem.quantityChildren)}"></span>
									</td>
									
									<td style="text-align: center; vertical-align: middle; display:flex;">
										
										<button style="margin-right:10px;" class="btn btn-primary btn-sm trash" th:onclick="'showUpdateForm('+${cartItem.CartItemId}+')'" type="button" 
											title="Update">
											<i class="fas fa-pen-square"></i>
										</button>
										<a th:href="@{|/travelfpoly/cart/delete/${cartItem.CartItemId}|}">
											<button class="btn btn-primary btn-sm trash" type="button"
												title="Xóa">
												<i class="fas fa-trash-alt"></i>
											</button>
										</a>
										
									</td>
									<td>
										<input type="checkbox" class="option-input checkbox" th:onchange="'updateSelection('+${cartItem.CartItemId}+', this)'"/>
									</td>
									<div th:id="updateForm+${cartItem.CartItemId}" style="display: none;">
										<div class="customForm">
											<i th:onclick="'closeUpdateForm('+${cartItem.CartItemId}+')'" class="fas fa-times-circle"></i>
											<form method="post">
								                <div class="form-group col-md-12">
								                  <label class="control-label" >Start Date</label>
								                  <input th:name="startDate" class="form-control" type="date" th:value="${#dates.format(cartItem.StartDate, 'yyyy-MM-dd')}">
								                </div>
								                <div class="form-group  col-md-12">
								                  <label class="control-label">Quantity Adult </label>
								                  <input th:name="adult" class="form-control" type="number" th:value="${cartItem.QuantityAdult}">
								                </div>
								                <div class="form-group  col-md-12">
								                  <label class="control-label">Quantity Children</label>
								                  <input th:name="children" class="form-control" type="number" th:value="${cartItem.QuantityChildren}">
								                </div>
								                <div class="form-group col-md-12">
								                	<button class="btn btn-success" type="submit" th:formaction="@{|/travelfpoly/cart/update/${cartItem.CartItemId}|}">Update</button>
								                </div>
										    </form>
										    
										</div>
									    
									</div>	
								</tr>
								<tr th:unless="${cartItems}!=null">
									<td colspan="6">Shopping cart is empty</td>
								</tr>
								
							</tbody>
						</table>
					</div>
					<div class="alert">
						<i class="fas fa-exclamation-triangle"></i> Enter product code or product name to search
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div th:object="${cart}" class="tile">
					<h3 class="tile-title">Order notification</h3>
					<form method="post">
						<div class="row">
							<div class="form-group  col-md-12">
								<label class="control-label">Fullname</label> 
								<input class="form-control" id="fullname" th:name="fullname" th:value="*{Name}" type="text" placeholder="Enter your fullname">
							</div>
							
							<div class="form-group  col-md-12">
								<label class="control-label">Phone</label> 
								<input class="form-control" id="phone" th:name="phone" th:value="*{Phone}" type="text" placeholder="Enter your phone">
							</div>
							
							<div class="form-group  col-md-12">
								<label class="control-label">Address</label> 
								<input class="form-control" id="address" th:name="address" th:value="*{Address}" type="text" placeholder="Cách mạng tháng 8, Quận Tân Bình">
							</div>
							
							<div class="form-group  col-md-12">
								<label class="control-label">Email</label> 
								<input class="form-control" id="email" th:name="email" th:value="*{Email}" type="text" placeholder="Enter your email">
							</div>
							<div class="form-group  col-md-12">
								<label class="control-label">Payment method</label> 
								<select class="form-control" id=payment name="paymentMethod">
									<option>--Choose payment method ---</option>
									<option value="paypal">&#x1F4B3; Paypal</option>
									<option value="vnpay">&#x1F4B3; VNPay</option>
									<option value="cash">&#x1F4B5; Cash</option>
								</select>
							</div>
							<div class="form-group  col-md-12">
								<label class="control-label">Not</label>
								<textarea class="form-control" rows="4"
									placeholder="Extra notes for your tour"></textarea>
							</div>
	
						</div>
					</form>
					<div class="row justify-content-between px-3 tile-footer">
						<div class="col-md-5">
							<button class="btn btn-primary luu-san-pham" onclick="buySelectedItems()">
								Book Tour
							</button>
						</div>
						<div class="col-md-5">
							<button class="btn btn-success luu-san-pham">
								Pay Online
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
	<!--
  MODAL
-->
	<div th:insert="~{include/_Footer}"></div>

	<div id="ftco-loader" class="show fullscreen">
		<svg class="circular" width="48px" height="48px">
			<circle class="path-bg" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke="#eeeeee" />
			<circle class="path" cx="24" cy="24" r="22" fill="none"
				stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" /></svg>
	</div>
	<script th:inline="javascript">
	    function showUpdateForm(cartItemId) {
	        document.getElementById("updateForm"+cartItemId).style.display = "block";
	        updateForm.classList.add("custom-form");
	    }
	    function closeUpdateForm(cartItemId) {
	        $("#updateForm"+cartItemId).hide();
	    }
	    var selectedItems = [];

	    function updateSelection(cartItemId, checkbox) {
	        var isChecked = checkbox.checked;

	        if (isChecked) {
	            selectedItems.push(cartItemId);
	        } else {
	            var index = selectedItems.indexOf(cartItemId);
	            if (index !== -1) {
	                selectedItems.splice(index, 1);
	            }
	        }
	    }
	    function gatherFormData() {
	        var formData = {
	            fullname: document.getElementById('fullname').value,
	            phone: document.getElementById('phone').value,
	            address: document.getElementById('address').value,
	            email: document.getElementById('email').value,
	            payment: document.getElementById('payment').value,
	            selectedItems: selectedItems
	        };

	        return formData;
	    }

	    function buySelectedItems() {
	    	var formData = gatherFormData();
	        $.ajax({
	            url: '/travelfpoly/cart/buySelectedItems',
	            type: 'POST',
	            contentType: 'application/json',
	            data: JSON.stringify(formData),
	            success: function(redirectUrl) {
	            	 window.location.href = redirectUrl;
	            }	
	        });
	    }
	</script>
	<script>
        const adultsSelect = document.getElementById('adult');
        const childrenSelect = document.getElementById('children');
        const priceAdult = document.getElementById('priceAdult');
        const priceChildren = document.getElementById('priceChildren');
        const displayElement = document.getElementById('totalPriceDisplay');
        
        adultsSelect.addEventListener('change', calculateTotalPrice);
        childrenSelect.addEventListener('change', calculateTotalPrice);
        
        function calculateTotalPrice() {
            const adultsQuantity = parseInt(adultsSelect.value);
            const childrenQuantity = parseInt(childrenSelect.value);
            const tourAdultPrice = parseFloat(priceAdult.getAttribute('data-price'));
            const tourChildrenPrice = parseFloat(priceChildren.getAttribute('data-price'));
			const totalPrice = (adultsQuantity * tourAdultPrice) + (childrenQuantity * tourChildrenPrice);
            displayElement.textContent =totalPrice + '$';
        }
    </script>
	<!-- <script>
	    // Bắt sự kiện khi giá trị thay đổi trong bất kỳ thẻ <select> nào trong class "cart-item"
	    
	    var selectElements = document.querySelectorAll(".cart-item select");
	    var totalAmount = parseFloat([[${totalPrice}]])
	    selectElements.forEach(function(selectElement) {
	        selectElement.addEventListener("change", updateTotalAmount);
	    });
	
	    // Hàm tính tổng tiền dựa trên số lượng và giá từng dòng
	    function updateTotalAmount() {
	        var totalAmount = 0;
	        
	        // Duyệt qua từng dòng
	        var rows = document.querySelectorAll(".cart-item");
	        rows.forEach(function(row) {
	            var quantityAdult = parseInt(row.querySelector(".quantityAdult").value);
	            var quantityChildren = parseInt(row.querySelector(".quantityChildren").value);
	            var pricePerAdult = parseFloat(row.querySelector(".pricePerAdult").textContent.replace('$', ''));
	            var pricePerAdult = parseFloat(row.querySelector(".pricePerChildren").textContent.replace('$', ''));
	            totalAmount += (quantityAdult * pricePerAdult) + (pricePerChildren * quantityChildren);
	        });
	
	        // Cập nhật giá trị tổng tiền trên giao diện
	        document.getElementById("totalAmount").textContent = totalAmount.toFixed(2); // Làm tròn đến 2 chữ số thập phân
	    }
	</script> -->
	<script src="/user/js/jquery.min.js"></script>
	<script src="/user/js/jquery-migrate-3.0.1.min.js"></script>
	<script src="/user/js/popper.min.js"></script>
	<script src="/user/js/bootstrap.min.js"></script>
	<script src="/user/js/jquery.easing.1.3.js"></script>
	<script src="/user/js/jquery.waypoints.min.js"></script>
	<script src="/user/js/jquery.stellar.min.js"></script>
	<script src="/user/js/owl.carousel.min.js"></script>
	<script src="/user/js/jquery.magnific-popup.min.js"></script>
	<script src="/user/js/aos.js"></script>
	<script src="/user/js/jquery.animateNumber.min.js"></script>
	<script src="/user/js/bootstrap-datepicker.js"></script>
	<script src="/user/js/jquery.timepicker.min.html"></script>
	<script src="/user/js/scrollax.min.js"></script>
	<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&amp;sensor=false"></script>
	<script src="/user/js/google-map.js"></script>
	<script src="/user/js/main.js"></script>

	<script async
		src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
	<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-23581568-13');
</script>
	<script defer
		src="https://static.cloudflareinsights.com/beacon.min.js/v52afc6f149f6479b8c77fa569edb01181681764108816"
		integrity="sha512-jGCTpDpBAYDGNYR5ztKt4BQPGef1P0giN6ZGVUi835kFF88FOmmn8jBQWNgrNd8g/Yu421NdgWhwQoaOPFflDw=="
		data-cf-beacon='{"rayId":"7de3eacc580c0ebc","version":"2023.4.0","b":1,"token":"cd0b4b3a733644fc843ef0b185f98241","si":100}'
		crossorigin="anonymous"></script>
</body>

<!-- Mirrored from preview.colorlib.com/theme/direngine/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 28 Jun 2023 06:37:10 GMT -->
</html>